<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="description"
        content= "SSP-IR is a one-stage diffusion-based restoration method with multimodal insights.">
  <meta name="keywords" content="Image Restoration, Diffusion model, Stable Diffusion">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>SSP-IR: Semantic and Structure Priors for Diffusion-based Realistic Image Restoration</title>

  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
        rel="stylesheet">

  <link rel="stylesheet" href="../static/css/bulma.min.css">
  <link rel="stylesheet" href="../static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="../static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="../static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="../static/css/index.css">
  <link rel="icon" href="./images/logo.svg">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="../static/js/fontawesome.all.min.js"></script>
  <script src="../static/js/bulma-carousel.min.js"></script>
  <script src="../static/js/bulma-slider.min.js"></script>
  <script src="../static/js/index.js"></script>

  <!-- Vendor Stylesheets -->
  <!--=================js==========================-->
  <link rel="stylesheet" href="../static/css/tab_gallery.css">
  <link rel="stylesheet" href="../static/css/juxtapose.css">
  <!-- <script src="../static/js/index.js"></script> -->
  <!-- <link rel="stylesheet" href="./menlo"> -->
  <link rel="stylesheet" href="../static/css/image_card_fader.css">
  <link rel="stylesheet" href="../static/css/image_card_slider.css">
</head>
<body>


<section class="hero">
  <div class="hero-body">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column has-text-centered">
          <h1 class="title is-1 publication-title">SSP-IR: Semantic and Structure Priors for Diffusion-based Realistic Image Restoration</h1>
          <div class="is-size-5 publication-authors">
            <span class="author-block">
              Yuhong Zhang</a><sup>1</sup>,</span>
            <span class="author-block">
              Hengsheng Zhang</a><sup>1</sup>,</span>
            </span>
            <span class="author-block">
              Zhengxue Cheng</a><sup>1</sup>,
            </span>
            <span class="author-block">
              Rong Xie</a><sup>1</sup>,
            </span>
            <span class="author-block">
              <a href="https://medialab.sjtu.edu.cn/author/li-song/">Li Song</a><sup>1</sup>,
            </span>
            <span class="author-block">
              Wenjun Zhang</a><sup>1</sup>
            </span>
          </div>

          <div class="is-size-5 publication-authors">
            <span class="author-block"><sup>1</sup>Shanghai Jiao Tong University</span>
          </div>

          <div class="column has-text-centered">
            <div class="publication-links">
              <!-- PDF Link. -->
              <span class="link-block">
                <a href="https://arxiv.org/abs/2407.03635"
                    class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fas fa-file-pdf"></i>
                  </span>
                  <span>Paper</span>
                </a>
              </span>
              <!-- Code Link. -->
              <span class="link-block">
                <a href="https://github.com/zyhrainbow/MRIR"
                    class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-github"></i>
                  </span>
                  <span>Code (Coming soon)</span>
                  </a>
              </span>

          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<!--=================Teasers==========================-->
<section class="hero is-small">
  <div class="hero-body">
    <div class="container is-max-desktop has-text-centered">
      <!-- The expanding image container -->
      <div class="tab_container">
        <!-- Close the image -->
        <!-- <span onclick="this.parentElement.style.display='none'" class="closebtn">&times;</span> -->

        <!-- Expanded image -->
        <div id="juxtapose-embed" data-startingposition="30%" data-animate="true" class="juxtapose"
          style="height: 400px; width: 400px;">
          <!-- <div class="jx-slider">
            <div class="jx-handle " style="left: 50%;">
              <div class="jx-arrow jx-left"></div>
              <div class="jx-control">
                <div class="jx-controller" tabindex="0" role="slider" aria-valuenow="50" aria-valuemin="0"
                  aria-valuemax="100"></div>
              </div>
              <div class="jx-arrow jx-right"></div>
            </div>
            <div class="jx-image jx-left " style="width: 50%;"><img src="./src/UDC_1.png" alt="">
              <div class="jx-label" tabindex="0">UDC images</div>
            </div>
            <div class="jx-image jx-right " style="width: 50%;"><img src="./src/AF_1.png" alt="">
              <div class="jx-label" tabindex="0">AlignFormer results</div>
            </div><a href="https://juxtapose.knightlab.com" target="_blank" rel="noopener" class="jx-knightlab">
              <div class="knightlab-logo"></div><span class="juxtapose-name">JuxtaposeJS</span>
            </a>
          </div> -->
        </div>

        <div>
          <div id="juxtapose-hidden"></div>
        </div>

        <!-- Image text -->
        <div id="imgtext"></div>
      </div>

      <!-- The grid: four columns -->
      <div class="tab_row">
        <div class="tab_column">
          <img src="./images/input/0000044.png" onclick="tab_gallery_click('0000044.png');">
        </div>
        <div class="tab_column">
          <img src="./images/input/0000046.png" onclick="tab_gallery_click('0000046.png');">
        </div>
        <div class="tab_column">
          <img src="./images/input/0000098.png" onclick="tab_gallery_click('0000098.png');">
        </div>
        <div class="tab_column">
          <img src="./images/input/0000196.png" onclick="tab_gallery_click('0000196.png');">
        </div>
        <div class="tab_column">
          <img src="./images/input/0000246.png" onclick="tab_gallery_click('0000246.png');">
        </div>
      </div>
      </div>
    </div>
  </div>
</section>


<section class="section">
  <div class="container is-max-desktop">
    <!-- Abstract. -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Abstract</h2>
        <div class="content has-text-justified">
          <p>
            Realistic image restoration is a crucial task in computer vision, and diffusion-based models for image restoration has garnered significant attention due to their ability to produce realistic results. 
            However, due to the severity of image degradation and the uncontrollability of the diffusion model, diffusion-based restoration methods still have many challenges in the perceptual quality, semantic fidelity, and structure accuracy. To address these challenges, we introduce a novel image restoration method, SSP-IR. Following the principle of ``reconstruction as conditional generation", our approach aims to fully exploit semantic and structure priors from low-quality images to guide the diffusion model to generate semantically faithful and structurally accurate natural restoration results. Specifically, we integrate the visual comprehension capabilities of Multimodal Large Language Models (explicit) and the visual representations of the original image (implicit) to acquire accurate semantic prior. To extract degradation-agnostic structure prior, we introduce a Processor with RGB and FFT constrains to extract structure prior from the low-quality images, guiding the diffusion model and preventing the generation of unreasonable artifacts. Lastly, we employ a multi-level attention mechanism to integrate the acquired semantic and structure priors. The qualitative and quantitative results demonstrate that our method outperforms other state-of-the-art methods overall on both synthetic and real-world datasets.
          </p>
        </div>
      </div>
    </div>
    <!--/ Abstract. -->

    <!-- Method. -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Method</h2>
        <div class="content has-text-justified">
          <div  style="text-align:center; vertical-align:middle">
            <img src="./images/framework_2.png" width="100%">
          </div>
          <div align="center">
            <b>Overview of the architecture of SSP-IR. </b>
          </div>
          <p>
           We propose a diffusion-based realistic image restoration method with semantic and structure priors. To fully leverage the generative priors of pre-trained T2I models such as stable diffusion, we utilize semantic and structure information from low-quality images to guide the diffusion process in image restoration, aiming to generate realistic restoration results with coherent structures and clear details. The overall framework of our model is depicted in the figure. 
           To generate more realistic results, we employ stable diffusion as the backbone. To make the generated results are more faithful, we control the diffusion process with the semantic and structure priors from input images. 
           To get the rich and faithful semantic prior, we design the extraction module with two branches: one branch utilizes the inference capability of a pre-trained multimodal language model to predict potential restoration results from the LQ images, generating restored text embeddings. 
           The textual prompts predicted by MLLM are explicit and can be reviewed and modified by the user to suit their needs. 
           Additionally, to ensure the semantic fidelity of the generated predictions to the original LQ images, we design an image embedding branch. 
           An image encoder extracts image embedding, and a Refine Layer is employed to correct the image embedding and mitigate the influence of degraded information in LQ images. 
           Image embedding is implicit and can contain semantic information in the original image that cannot be expressed by text. 
           The explicit text embedding and implicit image embedding collaborate as the semantic information to control the restoration process of the diffusion model. 
           To get degradation-independent structure control, we employ a constrained Processor and a ControlNet module. 
           The Processor extracts degradation-independent features from the low-quality image under the supervision of RGB loss and FFT loss at different scales, while the ControlNet module utilizes these features to generate structure control in the latent domain. 
           Finally, the denoising U-Net utilizes text embedding, image embedding, and strcuture control through attention mechanism to generate high-quality restoration results. 
          
          </p>
        </div>
      </div>
    </div>
  </div>
</section>


<section class="section">
  <div class="container is-max-desktop">
    <!-- Results. -->
    <div class="columns is-centered">
      <div class="column is-full-width">
        <h2 class="title is-3">Visual Results</h2>
        <h3 class="title is-4">Synthetic datasets</h3>
        <div class="content has-text-justified">
          <div  style="text-align:center; vertical-align:middle">
            <img src="./images/compare_synth.png" width="100%">
          </div>
          <div align="center">
            <b> Qualitative comparisons with different state-of-the-art methods on synthetic datasets. </b>
          </div>
        </div>

        <h3 class="title is-4">Real-world datasets</h3>
        <div class="content has-text-justified">
          <div  style="text-align:center; vertical-align:middle">
            <img src="./images/compare_real.png" width="100%">
          </div>
          <div align="center">
            <b> Qualitative comparisons with different state-of-the-art methods on real-world datasets. </b>
          </div>
        </div>

       
      </div>
    </div>
    <!--/ Results. -->
   
  </div>
</section>


<!-- <section class="section" id="BibTeX">
  <div class="container is-max-desktop content">
    <h2 class="title">BibTeX</h2>
    <pre><code>@misc{zhang2024mrir,
      title={MRIR: Integrating Multimodal Insights for Diffusion-based Realistic Image Restoration}, 
      author={Yuhong Zhang and Hengsheng Zhang and Xinning Chai and Rong Xie and Li Song and Wenjun Zhang},
      year={2024},
      eprint={2407.03635},
      archivePrefix={arXiv},
      primaryClass={cs.CV},
      url={https://arxiv.org/abs/2407.03635}, 
}</code></pre>
  </div>
</section> -->


<footer class="footer">
  <div class="container">
    <!-- <div class="content has-text-centered">
      <a class="icon-link"
         href="https://arxiv.org/abs/2407.03635">
        <i class="fas fa-file-pdf"></i>
      </a>
      <a class="icon-link" href="https://github.com/zyhrainbow/MRIR" class="external-link" disabled>
        <i class="fab fa-github"></i>
      </a>
    </div> -->
    <div class="columns is-centered">
      <div class="column is-8">
        <div class="content">
          <p>
            This website is licensed under a <a rel="license"
                                                href="http://creativecommons.org/licenses/by-sa/4.0/">Creative
            Commons Attribution-ShareAlike 4.0 International License</a>.
          </p>
          <p>
            Website adapted from the following <a
              href="https://github.com/nerfies/nerfies.github.io">source code</a>.
          </p>
        </div>
      </div>
    </div>
  </div>
</footer>
<!-- Image Slider Javascripts -->
<!--=================Functions==========================-->
<script src="../static/js/juxtapose.js"></script>



<script>
  var slider;
  let origImages = [
    { "src": "./images/input/0000044.png", "label": "Zoomed LQ images", },
    { "src": "./images/output/0000044.png", "label": "MRIR results", }
  ];
  let origOptions = {
    "makeResponsive": true,
    "showLabels": true,
    "mode": "horizontal",
    "showCredits": true,
    "animate": true,
    "startingPosition": "50"
  };

  const juxtaposeSelector = "#juxtapose-embed";
  const transientSelector = "#juxtapose-hidden";


  function tab_gallery_click(name) {
    // Get the expanded image
    let inputImage = {
      label: "Zoomed LQ images",
    };
    let outputImage = {
        label: "MRIR results",
      };

    inputImage.src = "./images/input/".concat(name)
    outputImage.src = "./images/output/".concat(name)

    let images = [inputImage, outputImage];
    let options = slider.options;
    options.callback = function (obj) {
      var newNode = document.getElementById(obj.selector.substring(1));
      var oldNode = document.getElementById(juxtaposeSelector.substring(1));
      console.log(obj.selector.substring(1));
      console.log(newNode.children[0]);
      oldNode.replaceChild(newNode.children[0], oldNode.children[0]);
      //newNode.removeChild(newNode.children[0]);

    };

    slider = new juxtapose.JXSlider(transientSelector, images, options);
  };

  (function () {
    slider = new juxtapose.JXSlider(
      juxtaposeSelector, origImages, origOptions);
    //document.getElementById("left-button").onclick = replaceLeft;
    //document.getElementById("right-button").onclick = replaceRight;
  })();
  // Get the image text
  var imgText = document.getElementById("imgtext");
  // Use the same src in the expanded image as the image being clicked on from the grid
  // expandImg.src = imgs.src;
  // Use the value of the alt attribute of the clickable image as text inside the expanded image
  imgText.innerHTML = name;
  // Show the container element (hidden with CSS)
  // expandImg.parentElement.style.display = "block";

  $(".flip-card").click(function () {
    console.log("fading in")
    div_back = $(this).children().children()[1]
    div_front = $(this).children().children()[0]
    // console.log($(this).children("div.flip-card-back"))
    console.log(div_back)
    $(div_front).addClass("out");
    $(div_front).removeClass("in");

    $(div_back).addClass("in");
    $(div_back).removeClass("out");

  });

  $(".flip-card").mouseleave(function () {
    console.log("fading in")
    div_back = $(this).children().children()[1]
    div_front = $(this).children().children()[0]
    // console.log($(this).children("div.flip-card-back"))
    console.log(div_back)
    $(div_front).addClass("in");
    $(div_front).removeClass("out");

    $(div_back).addClass("out");
    $(div_back).removeClass("in");

  });
</script>

</body>
</html>
